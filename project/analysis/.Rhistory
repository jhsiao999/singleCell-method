topics(t(molecules_single_cell_cycle), K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust",clust_vec)
clust_vec <- 2:7
topics_list <- lapply(clust_vec, function(per_clust) {
topics(t(molecules_single_cell_cycle), K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust",clust_vec)
save(topics_list,
file = "../rdas/clustering-cell-cycle-genes/topics-maximum-normalized.rda")
per_clust = 2
nclust <- length(topics_list)
type_info <- cell_phase_vector
topics_clust <- topics_list[[per_clust]]
clust <- topics_clust$K
docweights <- topics_clust$omega
type_ordered <- type_info[order(type_info)]
docweights_ordered <- docweights[order(type_info),]
barplot( t(docweights_ordered),
col = 2:(clust+1), axisnames = F,
space = 0, border=NA,
main = paste("No. of clusters=", clust), las = 1,
ylim = c(0,1), cex.axis = 0.3, cex.main=1.4)
per_clust = 2
per_clust = 1
topics_clust <- topics_list[[per_clust]]
clust <- topics_clust$K
docweights <- topics_clust$omega
type_ordered <- type_info[order(type_info)]
docweights_ordered <- docweights[order(type_info),]
barplot( t(docweights_ordered),
col = 2:(clust+1), axisnames = F,
space = 0, border=NA,
main = paste("No. of clusters=", clust), las = 1,
ylim = c(0,1), cex.axis = 0.3, cex.main=1.4)
?topic
?topics
require(Humanzee)
testDE
lcl_qc_data <- read_csv("../data/qc-lcl.csv");
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE);
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1));
library(readr)
library(data.table)
library(devtools)
library(CountClust)
library(parallel)
library(dplyr)
library(ggplot2)
library(edgeR)
library(gplots)
lcl_qc_data <- read_csv("../data/qc-lcl.csv");
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE);
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1));
install.packages("readr")
library(readr)
library(data.table)
library(devtools)
library(CountClust)
library(parallel)
library(dplyr)
library(ggplot2)
library(edgeR)
library(gplots)
lcl_qc_data <- read_csv("../data/qc-lcl.csv");
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE);
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1));
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,];
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_qc_data$ll_name
head(lcl_qc_data$ll_name)
head(lcl_annotations$well)
lcl_qc_data$ll_name
lcl_annotations$well
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
library(CountClust)
library(maptpx)
handleNA
?handleNA
head(lcl_molecules_refined)
str(lcl_molecules_refined)
(lcl_molecules_refined)[1:10, 1:10]
str(lcl_molecules)
StructureObj()
?StructureObj
?topics
lcl_qc_data$cell.num
lcl_qc_data$cell.num
lcl_qc_data$cell.num
library(readr)
library(data.table)
library(devtools)
library(CountClust)
library(parallel)
library(dplyr)
library(ggplot2)
library(edgeR)
library(gplots)
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1) )
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1) )
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
library(CountClust)
library(maptpx)
lcl_molecules_refined <- handleNA(lcl_molecules_refined)$data
# Try fitting 2 to 5 clusters
nclus_vec <- 2:5
bayesfac <- array(0,length(nclus_vec))
samp_metadata <- cbind.data.frame(1:96, lcl_qc_data$cell.num)
colnames(samp_metadata) = c("samples","no. of cells");
samp_metadata
lcl_molecules
str(lcl_molecules)
lcl_molecules[1:10, 1:10]
lcl_qc_data
dim(lcl_molecules)
dim(lcl_qc_data)
dim(lcl_annotations)
lcl_qc_data$cell.num
lcl_qc_data
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_annotations_refined
lcl_qc_data
dim(lcl_qc_data)
dim(lcl_annotations_refined)
head(lcl_annotations_refined)
lcl_qc_data
head(lcl_molecules_refined)
str(lcl_molecules_refined)
colnames(lcl_molecules_refined)
rownames(lcl_molecules_refined)
lcl_qc_data
str(lcl_qc_data)
lcl_qc_data_$ll_name
lcl_qc_data$ll_name
rownames(lcl_molecules_refined)
lcl_qc_data
ii_presentWell <- lcl_qc_data$cell.num > 0
summary(ii_presentWell)
lcl_annotations_refined
table(lcl_annotations_refined$batch)
dim(lcl_molecules_refined)
dim(lcl_annotations_refined)
dim(lcl_molecules_refined)
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[ii_presentWell,]
stopifnot(nrow(lcl_molecules_refined) == norow(lcl_annotations_refined))
str(lcl_molecules_refined)
colnames(lcl_molecules_refined)
tail(colnames(lcl_molecules_refined))
ii_ERCC <- grep("ERCC", colnames(lcl_molecules_refined))
grep("ERCC", colnames(lcl_molecules_refined))
ii_nonERCC <- grep("ERCC", colnames(lcl_molecules_refined), invert = TRUE)
dim(lcl_molecules_refined)
dim(lcl_annotations_refined)
lcl_molecules_refined <- lcl_molecules_refined[ , ii_nonERCC]
summary(lcl_molecules_refined)
range(lcl_molecules_refined)
overexpressed_genes <- colnames(molecules_single)[ apply(lcl_molecules_refined, 2,
function(x) any(x >= 1024))]
overexpressed_genes <- colnames(lcl_molecules_refined)[ apply(lcl_molecules_refined, 2,
function(x) any(x >= 1024))]
ii_overexpressed <- apply(lcl_molecules_refined, 2, function(x) any(x >= 1024) )
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
dim(lcl_qc_data)
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
dim(lcl_annotations)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1) )
dim(lcl_molecules)
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[ii_presentWell,]
stopifnot(nrow(lcl_molecules_refined) == nrow(lcl_annotations_refined))
ii_nonERCC <- grep("ERCC", colnames(lcl_molecules_refined), invert = TRUE)
lcl_molecules_refined <- lcl_molecules_refined[ , ii_nonERCC]
range(lcl_molecules_refined)
ii_notOverexpressed <- apply(lcl_molecules_refined, 2, function(x) any(x < 1024) )
lcl_molecules_refined <- lcl_molecules_refined[ , ii_notOverexpressed]
dim(lcl_molecules_refined)
library(CountClust)
library(maptpx)
# Remove rows with more than 1 missing values
lcl_molecules_refined <- handleNA(lcl_molecules_refined)$data
# Try fitting 2 to 5 clusters
nclus_vec <- 2:5
bayesfac <- array(0,length(nclus_vec))
if(file.exists("../rdas/lcl-structure.rda")) {
load("../rdas/lcl-structure.rda")
} else {
topics_list <- lapply(nclust_vec, function(per_clust) {
topics(t(molecules_single_cell_cycle), K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust", nclust_vec)
save(topics_list,
file = "../rdas/lcl-structure.rda")
}
# Try fitting 2 to 5 clusters
nclus_vec <- 2:5
if(file.exists("../rdas/lcl-structure.rda")) {
load("../rdas/lcl-structure.rda")
} else {
topics_list <- lapply(nclust_vec, function(per_clust) {
topics(t(molecules_single_cell_cycle), K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust", nclust_vec)
save(topics_list,
file = "../rdas/lcl-structure.rda")
}
nclust_vec <- 2:5
if(file.exists("../rdas/lcl-structure.rda")) {
load("../rdas/lcl-structure.rda")
} else {
topics_list <- lapply(nclust_vec, function(per_clust) {
topics(t(molecules_single_cell_cycle), K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust", nclust_vec)
save(topics_list,
file = "../rdas/lcl-structure.rda")
}
?topics
if(file.exists("../rdas/lcl-structure.rda")) {
load("../rdas/lcl-structure.rda")
} else {
topics_list <- lapply(nclust_vec, function(per_clust) {
topics( lcl_molecules_refined, K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust", nclust_vec)
save(topics_list,
file = "../rdas/lcl-structure.rda")
}
well_id <- lcl_annotations_refined$well
ids <- sapply(well_id, function(x) substring(x,2,3))
batch_lab <- array(0, length(ids))
batch_lab[which(ids=="01" | ids=="02" | ids=="03")] <- 1
batch_lab[which(ids=="04" | ids=="05" | ids=="06")] <- 2
batch_lab[which(ids=="07" | ids=="08" | ids=="09")] <- 3
batch_lab[which(ids=="10" | ids=="11" | ids=="12")] <- 4
batch_lab <- factor(batch_lab, levels = c(1:4))
batch_lab
lcl_annotations_refined$well
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
dim(lcl_qc_data)
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
dim(lcl_annotations)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1) )
dim(lcl_molecules)
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[ii_presentWell,]
stopifnot(nrow(lcl_molecules_refined) == nrow(lcl_annotations_refined))
ii_nonERCC <- grep("ERCC", colnames(lcl_molecules_refined), invert = TRUE)
lcl_molecules_refined <- lcl_molecules_refined[ , ii_nonERCC]
rownames(lcl_molecules_refined)
range(lcl_molecules_refined)
ii_notOverexpressed <- apply(lcl_molecules_refined, 2, function(x) any(x < 1024) )
lcl_molecules_refined <- lcl_molecules_refined[ , ii_notOverexpressed]
dim(lcl_molecules_refined)
nrow(lcl_molecules_refined)
nrow(lcl_annotations_refined)
lcl_annotations_refined$well
nrow(lcl_molecules_refined)
rownames(lcl_molecules_refined)
dim(lcl_annotations_refined)
dim(lcl_molecules_refined)
rownames(lcl_molecules_refined)
lcl_annotations_refined$well
library(readr)
library(data.table)
library(devtools)
library(CountClust)
library(parallel)
library(dplyr)
library(ggplot2)
library(edgeR)
library(gplots)
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
dim(lcl_qc_data)
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
dim(lcl_annotations)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1))
dim(lcl_molecules)
lcl_qc_data$ll_name
lcl_annotations$well
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
rownames(lcl_molecules_refined)
rownames(lcl_annotations_refined)
head(lcl_annotations_refined)
lcl_annotations_refined$well
head(cbind(lcl_annotations_refined$well, rownames(lcl_molecules_refined)))
head(cbind(lcl_annotations_refined$well, rownames(lcl_molecules_refined)))
str(lcl_annotations_refined)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)))
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),13)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),14)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),15)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),16)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),17)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),18)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),10)
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
str(ll_qc_data$cell.num)
str(lcl_qc_data$cell.num)
head(ll_qc_data)
head(lcl_qc_data)
head(lcl_qc_data,14)
lcl_qc_data$ll_name
dim(lcl_qc_data)
dim(lcl_molecules_refined)
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations[ii_presentWell,]
stopifnot(nrow(lcl_molecules_refined) == nrow(lcl_annotations_refined))
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),10)
dim(lcl_molecules_refined)
ii_nonERCC <- grep("ERCC", colnames(lcl_molecules_refined), invert = TRUE)
lcl_molecules_refined <- lcl_molecules_refined[ , ii_nonERCC]
range(lcl_molecules_refined)
ii_notOverexpressed <- apply(lcl_molecules_refined, 2, function(x) any(x < 1024) )
lcl_molecules_refined <- lcl_molecules_refined[ , ii_notOverexpressed]
dim(lcl_molecules_refined)
lcl_annotations_refined$well
table(rownames(lcl_molecules_refined))
table(lcl_annotations_refined$well)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),10)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),20)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)),23)
library(readr)
library(data.table)
library(devtools)
library(CountClust)
library(parallel)
library(dplyr)
library(ggplot2)
library(edgeR)
library(gplots)
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
dim(lcl_qc_data)
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
dim(lcl_annotations)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1))
dim(lcl_molecules)
rownames(lcl_molecules_refined)
lcl_qc_data <- read_csv("../data/qc-lcl.csv")
dim(lcl_qc_data)
lcl_annotations <- read.table('../data/annotation-lcl.txt',header=TRUE)
dim(lcl_annotations)
lcl_molecules <- t(data.frame(fread('../data/molecules-lcl.txt'), row.names = 1))
dim(lcl_molecules)
rownames(lcl_molecules)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)),23)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)), 30)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)), 40)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)), 60)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)), 80)
head(cbind(as.character(lcl_annotations$well), rownames(lcl_molecules)), 90)
lcl_molecules_refined <- lcl_molecules[ match(lcl_qc_data$ll_name,
lcl_annotations$well), ]
lcl_annotations_refined <- lcl_annotations[ match(lcl_qc_data$ll_name,
lcl_annotations$well), ]
head(cbind(as.character(lcl_annotations_refind$well), rownames(lcl_molecules_refind)), 90)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)), 90)
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)), 13)
```{r}
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations[ii_presentWell,]
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)), 13)
lcl_indices <- match(lcl_qc_data$ll_name, lcl_annotations$well)
lcl_molecules_refined <- lcl_molecules[lcl_indices,]
lcl_annotations_refined <- lcl_annotations[lcl_indices,]
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)), 13)
ii_presentWell <- which(lcl_qc_data$cell.num > 0)
lcl_molecules_refined <- lcl_molecules_refined[ii_presentWell, ]
lcl_annotations_refined <- lcl_annotations_refined[ii_presentWell,]
stopifnot(nrow(lcl_molecules_refined) == nrow(lcl_annotations_refined))
dim(lcl_molecules_refined)
head(cbind(as.character(lcl_annotations_refined$well), rownames(lcl_molecules_refined)), 13)
ii_nonERCC <- grep("ERCC", colnames(lcl_molecules_refined), invert = TRUE)
lcl_molecules_refined <- lcl_molecules_refined[ , ii_nonERCC]
range(lcl_molecules_refined)
ii_notOverexpressed <- apply(lcl_molecules_refined, 2, function(x) any(x < 1024) )
lcl_molecules_refined <- lcl_molecules_refined[ , ii_notOverexpressed]
dim(lcl_molecules_refined)
table(lcl_annotations_refined$well)
well_id <- lcl_annotations_refined$well
ids <- sapply(well_id, function(x) substring(x,2,3))
batch_lab <- array(0, length(ids))
batch_lab[which(ids=="01" | ids=="02" | ids=="03")] <- 1
batch_lab[which(ids=="04" | ids=="05" | ids=="06")] <- 2
batch_lab[which(ids=="07" | ids=="08" | ids=="09")] <- 3
batch_lab[which(ids=="10" | ids=="11" | ids=="12")] <- 4
batch_lab <- factor(batch_lab, levels = c(1:4))
library(CountClust)
library(maptpx)
# Remove rows with more than 1 missing values
lcl_molecules_refined <- handleNA(lcl_molecules_refined)$data
# Try fitting 2 to 5 clusters
nclust_vec <- 2:5
topics_list <- lapply(nclust_vec, function(per_clust) {
topics( lcl_molecules_refined, K = per_clust, tol = 0.005)
})
names(topics_list) <- paste0("clust", nclust_vec)
save(topics_list,
file = "../rdas/lcl-structure.rda")
nclust <- length(topics_list)
type_info <- batch_lab
nclust
for (per_clust in 1:nclust) {
topics_clust <- topics_list[[per_clust]]
clust <- topics_clust$K
docweights <- topics_clust$omega
type_ordered <- type_info[order(type_info)]
docweights_ordered <- docweights[order(type_info),]
barplot( t(docweights_ordered),
col = 2:(clust+1), axisnames = F,
space = 0, border=NA,
main = paste("No. of clusters=", clust), las = 1,
ylim = c(0,1), cex.axis = 0.3, cex.main=1.4)
labels <- match(unique(type_ordered), type_ordered)
abline(v=labels-1)
labels_low <- labels-1
labels_up <- c(labels_low[2:length(labels_low)], dim(docweights_ordered)[1])
mid_point <- labels_low +0.5*(labels_up-labels_low)
axis(1, at = mid_point, unique(type_ordered), las = 2, cex.axis=0.3)
}
BatchCorrectedCount
BatchCorrectedCounts
require(devtools)
install_github("kkdey/CountClust")
require(CountClust)
a <- rnorm(1:20)
b <- rep(1:2, each = 10)
fit <- lm(b ~ a)
options(contrast = "contr.sum")
fit2 <- lm(b ~ a)
fit
fit2
summary(fit)
summary(fit2)
b <- as.factor(rep(1:2, each = 10))
fit
fit2
fit$residuals
fit2$residuals
BatchCorrectedCounts
data <- lcl_molecules_refined
cpm_data <- log(data + 0.5)
g = 1
out <- lm(cpm_data[, g] ~ batch_lab)
options(contrast = "contr.sum")
out2 <- lm(cpm_data[, g] ~ batch_lab)
summary(out)
summary(out2)
out
summary(out)
str(out)
sum(out$coefficients)
out$coefficients
out2$coefficients
sum(out$coefficients)
sum(out$coefficients[-1])
sum(out$coefficients[-1]) < .99
options(contrast = "contr.sum")
out2 <- lm(cpm_data[, g] ~ batch_lab)
out2$contrasts
out2 <- lm(cpm_data[, g] ~ batch_lab,
contrasts = list(batch_lab = "contr.sum"))
out2$contrasts
out2$coef
out$coef
sum(out2$coef)
sum(out$coef)
out$residuals
out2$residuals
sum(out$residuals^2)
sum(out2$residuals^2)
