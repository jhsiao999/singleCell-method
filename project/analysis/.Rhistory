library(metagenomeSeq)
data("mouseData")
dim(mouseData)
metadata <- pData(mouseData);
dim(metadata)
library(metagenomeSeq)
data("mouseData")
metadata <- pData(mouseData);
count_filtered <- filterData(MRcounts(mouseData), present = 10, depth = 100)
dim(count_filtered)
library(metagenomeSeq)
data("mouseData")
metadata <- pData(mouseData);
counts <- MRcounts(mouseData)
dim(counts)
metadata[1:3,1:5]
dim(counts)
rm(list=ls())
library(maptpx)
library(CountClust)
library(metagenomeSeq)
data("mouseData")
metadata <- pData(mouseData);
counts <- t(MRcounts(mouseData))
samp_metadata <- cbind.data.frame(metadata$diet, metadata$relativeTime, metadata$status)
colnames(samp_metadata) <- c("diet","rel.time","status");
if(!dir.exists("../plots/mouse-metagenome")) dir.create("../plots/mouse-metagenome")
nclus_vec <- 2:6;
if (file.exists("./rdas/mouse_metagenome.rda")) {
mouse_metagenome_topics <- load("./rdas/mouse-metagenome.rda");
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.001, batch_lab = NULL, path_rda="./rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- load("./rdas/mouse-metagenome.rda");
}
getwd()
setwd('/Users/kushal/Documents/metagenomics/project/')
if(!dir.exists("../plots/mouse-metagenome")) dir.create("../plots/mouse-metagenome")
nclus_vec <- 2:6;
if (file.exists("./rdas/mouse_metagenome.rda")) {
mouse_metagenome_topics <- load("./rdas/mouse-metagenome.rda");
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="./rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- load("./rdas/mouse-metagenome.rda");
}
for(num in 1:length(nclus_vec))
{
obj <- StructureObj_omega(mouse_metagenome_topics[[num]]$omega, samp_metadata = samp_metadata, batch_lab = NULL,partition = rep("TRUE",dim(samp_metadata)[2]),path_struct='../plots/mouse-metagenome',control=list(cex.axis=1));
}
mouse_metagenome_topics[[1]]
mouse_metagenome_topics[[1]]$omega
if(!dir.exists("../plots/mouse-metagenome")) dir.create("../plots/mouse-metagenome")
nclus_vec <- 2:6;
if (file.exists("rdas/mouse_metagenome.rda")) {
mouse_metagenome_topics <- load("rdas/mouse-metagenome.rda");
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- load("rdas/mouse-metagenome.rda");
}
mouse_metagenome_topics
mouse_metagenome_topics[[1]]
load("/Users/kushal/Documents/metagenomics/project/rdas/mouse-metagenome.rda")
if(!dir.exists("../plots/mouse-metagenome")) dir.create("../plots/mouse-metagenome")
nclus_vec <- 2:6;
if (file.exists("rdas/mouse_metagenome.rda")) {
mouse_metagenome_topics <- get(load("rdas/mouse-metagenome.rda"));
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- get(load("rdas/mouse-metagenome.rda"));
}
for(num in 1:length(nclus_vec))
{
obj <- StructureObj_omega(mouse_metagenome_topics[[num]]$omega, samp_metadata = samp_metadata, batch_lab = NULL,partition = rep("TRUE",dim(samp_metadata)[2]),path_struct='../plots/mouse-metagenome',control=list(cex.axis=1));
}
nclus_vec <- 2:6;
if (file.exists("rdas/mouse_metagenome.rda")) {
mouse_metagenome_topics <- get(load("rdas/mouse-metagenome.rda"));
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- get(load("rdas/mouse-metagenome.rda"));
}
file.exists("./rdas/mouse_metagenome.rda")
getwd()
nclus_vec <- 2:6;
if (file.exists("./rdas/mouse-metagenome.rda")) {
mouse_metagenome_topics <- get(load("./rdas/mouse-metagenome.rda"));
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="./rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- get(load("./rdas/mouse-metagenome.rda"));
}
for(num in 1:length(nclus_vec))
{
obj <- StructureObj_omega(mouse_metagenome_topics[[num]]$omega, samp_metadata = samp_metadata, batch_lab = NULL,partition = rep("TRUE",dim(samp_metadata)[2]),path_struct='../plots/mouse-metagenome',control=list(cex.axis=1));
}
theta <- mouse_metagenome_topics[[2]]$theta;
theta <- mouse_metagenome_topics[[1]]$theta;
dim(theta)
features <- ExtractTopFeatures(theta,top_features=50,method="poisson")
features
features_vec <- unique(as.vector(features));
class <- as.numeric(apply(theta[features_vec,], 1, which.max))
rownames(theta)
driving_otus <- rownames(theta[features_vec,]);
driving_otus
driving_otus_per_class <- lapply(1:dim(theta)[2], function(x) driving_otus[which(class==x)]);
driving_otus_per_class
save(driving_otus_per_class, file="rdas/driving_otu_clus_2.rda")
barplot(c(1,1), col=2:3)
barplot(rep(1,7), col=2:8)
names(driving_otus_per_class) <- c("red","green")
driving_otus_per_class
theta <- mouse_metagenome_topics[[6]]$theta;
theta <- mouse_metagenome_topics[[5]]$theta;
dim(theta)
if(!dir.exists("../plots/mouse-metagenome")) dir.create("../plots/mouse-metagenome")
nclus_vec <- 2:7;
if (file.exists("./rdas/mouse-metagenome.rda")) {
mouse_metagenome_topics <- get(load("./rdas/mouse-metagenome.rda"));
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="./rdas/mouse-metagenome.rda",path_struct = "../plots/mouse-metagenome");
mouse_metagenome_topics <- get(load("./rdas/mouse-metagenome.rda"));
}
for(num in 1:length(nclus_vec))
{
obj <- StructureObj_omega(mouse_metagenome_topics[[num]]$omega, samp_metadata = samp_metadata, batch_lab = NULL,partition = rep("TRUE",dim(samp_metadata)[2]),path_struct='../plots/mouse-metagenome',control=list(cex.axis=1));
}
theta <- mouse_metagenome_topics[[6]]$theta;
dim(theta)
theta <- mouse_metagenome_topics[[6]]$theta;
features <- ExtractTopFeatures(theta,top_features=50,method="poisson")
features_vec <- unique(as.vector(features));
class <- as.numeric(apply(theta[features_vec,], 1, which.max))
driving_otus <- rownames(theta[features_vec,]);
driving_otus_per_class <- lapply(1:dim(theta)[2], function(x) driving_otus[which(class==x)]);
length(driving_otus_per_class)
names(driving_otus_per_class) <- c("red","green","blue","cyan","pink","yellow","gray");
save(driving_otus_per_class, file="rdas/driving_otu_clus_7.rda")
driving_otus_per_class[[3]]
driving_otus_per_class[[5]]
load("./data/msd.rdata")
load("msd.rdata")
require(BiocInstaller)
biocLite(“msd16s”)
biocLite("msd16s")
require(msd16s)
load("msd.rdata")
data(msd16s)
metadata <- pData(msd16s);
dim(metadata)
counts <- t(MRcounts(mouseData))
dim(counts)
counts <- t(MRcounts(msd16s))
dim(counts)
metadata[1:3,1:5]
AgeFactor
metadata$AgeFactor
metadata[1:3,1:5]
if(!dir.exists("../plots/diarrhea-metagenome")) dir.create("../plots/diarrhea-metagenome")
nclus_vec <- 2:7;
if (file.exists("./rdas/diarrhea-metagenome.rda")) {
diarrhea_metagenome_topics <- get(load("./rdas/diarrhea-metagenome.rda"));
} else {
StructureObj(counts ,nclus_vec,samp_metadata = samp_metadata, tol=0.0005, batch_lab = NULL, path_rda="./rdas/diarrhea-metagenome.rda",path_struct = "../plots/diarrhea-metagenome");
diarrhea_metagenome_topics <- get(load("./rdas/diarrhea-metagenome.rda"));
}
for(num in 1:length(nclus_vec))
{
obj <- StructureObj_omega(diarrhea_metagenome_topics[[num]]$omega, samp_metadata = samp_metadata, batch_lab = NULL,partition = rep("TRUE",dim(samp_metadata)[2]),path_struct='../plots/diarrhea-metagenome',control=list(cex.axis=1));
}
barplot(rep(1,7),col=2:8)
install_github('kkdey/Countclust')
library(devtools)
install_github('kkdey/Countclust')
theta <- diarrhea_metagenome_topics[[1]]$theta;
features <- ExtractTopFeatures(theta,top_features=50,method="poisson")
features_vec <- unique(as.vector(features));
class <- as.numeric(apply(theta[features_vec,], 1, which.max))
driving_otus <- rownames(theta[features_vec,]);
driving_otus_per_class <- lapply(1:dim(theta)[2], function(x) driving_otus[which(class==x)]);
names(driving_otus_per_class) <- c("red","green")
save(driving_otus_per_class, file="rdas/driving_otu_diarrhea_clus_2.rda")
setwd('/Users/kushal/Documents/singleCell-method/project/analysis/')
out <- read.table("../data/Teichmann_data/Teichmann_singlecell_counts")
dim(out)
out[1:5,1:5]
out[1,]
out1 <- data.frame(fread('../data/Teichmann_data/Teichmann_counts_alleles_serum1'))
library(data.table)
out1 <- data.frame(fread('../data/Teichmann_data/Teichmann_counts_alleles_serum1'))
dim(out1)
out1[1,]
out <- read.table("../data/Teichmann_data/Teichmann_singlecell_counts")
out[1:3,1:5]
colnames(out)
out <- data.frame(fread("../data/Teichmann_data/Teichmann_singlecell_counts"));
out[1:3,1:4]
out <- fread("../data/Teichmann_data/Teichmann_singlecell_counts");
out[1,:17]
out[1,17]
out[1:4,]
out[1:4,1:5]
out <- scan("../data/Teichmann_data/Teichmann_singlecell_counts");
out <- read.table("../data/Teichmann_data/Teichmann_singlecell_counts");
out[1:3,1:5]
out1 <- read.table("../data/Teichmann_data/Teichmann_bulk_counts");
out1[1:3,1:4]
colnames(out1)
dim(out1)
dim(out)
a2i_single <- read.table('../data/Teichmann_data/Teichmann_counts_alleles_a2i');
dim(a2i_single)
