---
title: "Make SummarizedExperiment objects"
author: "Joyce Hsiao"
date: "2016-02-13"
output: 
  html_document:
    css: floating-toc.css
    toc: true
---


## Background and objectives

A how-to example of storing RNA-seq data in *SummarizedExperiment object*. We use a single-cell RNA-seq data that have been described and analyzed extensively in this [site][site].

*SummarizedExperiment* package contains many useful functions for manipulating this object class. See the [vignette][vignette] for details.

[vignette]: https://bioconductor.org/packages/3.3/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html

[site]: http://jdblischak.github.io/singleCellSeq/analysis/


## Load packages

```{r}
require(GenomicRanges)
```


## Import data 

Import molecule counts after QC-filtering.

```{r}
# import count matrix, convert to a matrix object
counts <- as.matrix(
    read.table("../data/gilad-2015/molecules-filter.txt",
               header = TRUE, stringsAsFactors = FALSE) )

# import annotation matrix, conver to a DatFrame object
col_data <- DataFrame(
    read.table("../data/gilad-2015/annotation-filter.txt",
               header = TRUE, stringsAsFactors = FALSE) )

# make an empty GRanges list 
row_data <- relist(GRanges(), vector("list", length=nrow(counts)))
mcols(row_data) <- rownames(counts)

# experiment description
exptData <- c("single-cell RNA-seq data collected on 96-well Fluidigm C1 plate ")

# putting all together
tung_hipsc <- SummarizedExperiment(
        assays = list(counts=counts),
        rowRanges = row_data,
        colData = col_data,
        exptData = SimpleList(exptData = exptData) )

# assign row names
rownames(tung_hipsc) <- rownames(counts)

tung_hipsc
```

## Access count matrix.

```{r}
str(assays(tung_hipsc)$counts)
```

## Access row information - gene names.

```{r}
str(rownames(tung_hipsc))
```

## Access column information -- cell IDs.

```{r}
colData(tung_hipsc)
```

## Access experiment description.

```{r}
exptData(tung_hipsc)
```


## Session information
```{r}
sessionInfo()
```

